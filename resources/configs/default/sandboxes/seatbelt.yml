version: 1.0.0
name: seatbelt
type: seatbelt
permissions:
  - network
  - filesystem

# Paths always mounted read-only (system libs, binaries)
execution_ro_paths:
  - /usr
  - /bin
  - /sbin
  - /etc
  - /private/etc
  - /Library
  - /System
  - /private/var/db
  - /private/var/select
  - /dev
  - /opt/homebrew
  - /usr/local
  - /var/run
  - /private/var/run
  - "~"

# Paths always mounted read-write (package managers)
execution_rw_paths:
  - "~/.npm"
  - "~/.cache/uv"
  - "~/.local/share/uv"

# Additional read-write when FILESYSTEM permission granted
filesystem_paths:
  - /tmp
  - /private/tmp

# Unix sockets (rootless sockets enabled by default)
# ⚠️ Root-owned sockets (/var/run/docker.sock) are commented out for security
# See OWASP Rule #1: https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html
socket_paths:
  - ~/.docker/run/docker.sock      # Docker (rootless)
  - ~/.orbstack/run/docker.sock    # OrbStack
  - ~/.rd/docker.sock              # Rancher Desktop
  - ~/.colima/default/docker.sock  # Colima
  # - /var/run/docker.sock         # Docker (root) - UNSAFE

timeout: 10
